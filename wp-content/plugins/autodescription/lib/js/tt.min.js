'use strict';window.tsfTT=function(a){const b="tsf-tooltip",c=`.${b}`,d="tsf-tooltip-item",e=`.${d}`,f=`.${"tsf-tooltip-wrap"}`,g=()=>{let g,j,n=!1,o=!1,p={},q={};try{(()=>{const a={get passive(){return n=!0,!1},get capture(){return o=!0,!1}};window.addEventListener("tsf-tt-test-passive",null,a),window.removeEventListener("tsf-tt-test-passive",null,a)})()}catch(a){n=!1,o=!1}const r=(b,c)=>{c=c||!1;let d="pointerdown.tsfTT touchstart.tsfTT click.tsfTT",e=a(b);c?(e.off("mousemove.tsfTT mouseleave.tsfTT mouseout.tsfTT blur.tsfTT"),a(document.body).off(d)):(e.on({"mousemove.tsfTT":z,"mouseleave.tsfTT":A,"mouseout.tsfTT":A,"blur.tsfTT":A}),a(document.body).off(d).on(d,B)),e.off("tsf-tooltip-update").on("tsf-tooltip-update",t)},s=a=>r(a,!0),t=b=>{if(b.target.classList.contains(d)){let c=b.target.querySelector(".tsf-tooltip-text");c instanceof Element&&(c.innerHTML=b.target.dataset.desc,a(b.target).trigger("mousemove.tsfTT"))}},u=()=>{g=requestAnimationFrame(w)},v=()=>{j=void 0,q={tooltip:void 0,arrow:void 0,wrap:void 0},p={last:{x:void 0},curr:{x:void 0}},cancelAnimationFrame(g)},w=()=>{var a=Math.round;let b=![p.curr.x].includes(NaN);if(b&&p.curr.x===p.last.x)return void u();p.last.x=p.curr.x;const d=j;let e=q.tooltip||d&&d.target.querySelector(c);if(!e)return void u();q.tooltip||(q.tooltip=e),q.arrow||(q.arrow=e.querySelector(".tsf-tooltip-arrow")),q.wrap||(q.wrap=d.target.closest(f)||d.target.parentNode);let g=p.curr.x,h=7,i=16;"focus"===d.type?g=d.target.getBoundingClientRect().left+d.target.offsetWidth/2:isNaN(g)&&(g=q.tooltip.dataset.lastPagex||d.target.getBoundingClientRect().left),q.tooltip.dataset.lastPagex=g;let k=g-q.wrap.getBoundingClientRect().left-i/2,l=q.tooltip.querySelector(".tsf-tooltip-text-wrap"),m=l.offsetWidth,n=q.tooltip.dataset.adjust,o=m-i-h;if(n=parseInt(n,10),n=isNaN(n)?0:a(n),n&&(k-=n,o+n>q.wrap.offsetWidth)){let a=l.querySelector(".tsf-tooltip-text"),b=a.offsetWidth;o=b-i-h}q.arrow.style.left=k<=h?h+"px":k>=o?o+"px":k+"px",b?u():v()},x=a=>{k(a.target)||(a.preventDefault(),setTimeout(()=>i(a.target)))},y=a=>{let c=a.target.dataset.desc||a.target.title||"";c&&!a.target.getElementsByClassName(b).length&&(a.target.dataset.desc=c,a.target.removeAttribute("title"),h(a,a.target,c))},z=a=>{p.curr.x=a.pageX||NaN,j=a},A=a=>{m(a.target),s(a.target),v()},B=a=>{if(a.target.dataset.hasTooltip)return;if(a.target instanceof HTMLInputElement&&a.target.id){let b=document.querySelectorAll(`label[for="${a.target.id}"]`);if(b.length&&[...b].some(a=>a.dataset.hasTooltip))return}let b;if(a.target.classList.contains(d)&&(b=a.target),!b){let d=a.target.querySelectorAll(e);for(const a of d)if(a.querySelector(c)){b=a;break}}if(b)for(const a of document.querySelectorAll(c))a.closest(e)!==b&&(m(a),s(a));else{for(const a of document.querySelectorAll(e))m(a),s(a);v()}},C=a=>{if(a.target.dataset.hasTooltip)return;let b=!1;switch(a.type){case"mouseenter":break;case"pointerdown":case"touchstart":b=!0;break;case"focus":default:}b?B(a):i(a.target),v(),y(a),z(a),u(),r(a.target)};let D=!1;const E=a=>{D||(D=!0,a.target.classList.contains(d)&&C(a),a.stopPropagation(),D=!1)};let F;const G=!(n||o)||{capture:!0,passive:!0},H=()=>{clearTimeout(F),F=setTimeout(()=>{let a=document.querySelectorAll(f),b="mouseenter pointerdown touchstart focus".split(" ");for(let c=0;c<a.length;c++)b.forEach(b=>{a[c].addEventListener(b,E,G)}),a[c].addEventListener("click",x,!!o&&{capture:!1})},25)};H(),a(window).on("tsf-tooltip-reset",H),l("#wpwrap")},h=(d,e,g)=>{var h=Math.min;if(e instanceof a&&(e=e.get(0)),e.dataset.hasTooltip=1,e.querySelector(c)&&m(e),!g.length)return;let i=document.createElement("div");i.classList.add(b),i.insertAdjacentHTML("afterbegin",`<span class="tsf-tooltip-text-wrap"><span class="tsf-tooltip-text">${g}</span></span><div class="tsf-tooltip-arrow" style=will-change:left></div>`),e.prepend(i);let j=e.closest(".tsf-tooltip-boundary")||document.body,k=j.getBoundingClientRect(),l=k.top-(j.scrollTop||0),n=j.offsetWidth,o=250,p=12,q=e.closest(f)||e.parentElement,r=q.getBoundingClientRect(),s=i.querySelector(".tsf-tooltip-text-wrap"),t=s.getBoundingClientRect(),u=r.width;t.width>o&&u<o&&150<u&&(s.style.flexBasis=u+"px"),s.offsetWidth>n-p/2?(s.style.flexBasis=h(o,n-p)+"px",p/=2):t.width>o&&(s.style.flexBasis=o+"px");let v=k.left-(j.scrollLeft||0),w=v+n,x=s.offsetWidth,y=t.left,z=y+x,A=0;if(y<v)A=v-y+p;else if(z>w)A=w-y-x-p;else if(42>u)A=-u/2-p;else if(u>x){let a=d&&d.pageX||NaN;A=d&&"focus"===d.type?u/2-x/2:isNaN(a)?-p:a-r.left-x/2;let b=-p,c=u-x+p;A<b&&(A=b),A>c&&(A=c)}if(A+y<v+p){let a=A+y-(v+p/2);A-=a}if(A+z>w+p){let a=A+z-(w+p/2);A-=a}if(A+y<v&&(A=0),!d){let a=parseInt(s.style.flexBasis,10);A<-a&&(A=-a)}i.style.left=A+"px",i.dataset.adjust=A;let B=e.offsetHeight+8,C=i.getBoundingClientRect().top-B;l>C?(i.classList.add("tsf-tooltip-down"),i.style.top=B+"px"):i.style.bottom=B+"px"},i=a=>{if(a instanceof Element){if(a.dataset.preventedClick=1,a instanceof HTMLLabelElement&&a.htmlFor){let b=document.getElementById(a.htmlFor);b&&(b.dataset.preventedClick=1)}if(a instanceof HTMLInputElement&&a.id){let b=document.querySelectorAll(`label[for="${a.id}"]`);b&&b.forEach(a=>a.dataset.preventedClick=1)}}},j=a=>{if(a instanceof Element){if(delete a.dataset.preventedClick,a instanceof HTMLLabelElement&&a.htmlFor){let b=document.getElementById(a.htmlFor);b&&delete b.dataset.preventedClick}if(a instanceof HTMLInputElement&&a.id){let b=document.querySelectorAll(`label[for="${a.id}"]`);b&&b.forEach(a=>delete a.dataset.preventedClick)}}},k=a=>a instanceof Element&&+a.dataset.preventedClick,l=b=>{a(b).addClass("tsf-tooltip-boundary")},m=b=>{b instanceof a&&(b=b.get(0)),b instanceof HTMLElement&&(delete b.dataset.hasTooltip,j(b)),n(b).remove()},n=b=>a(b).find(c).first();return Object.assign({load:()=>{document.body.addEventListener("tsf-ready",g)}},{doTooltip:h,removeTooltip:m,getTooltip:n,addBoundary:l,triggerReset:()=>{window.dispatchEvent(new CustomEvent("tsf-tooltip-reset"))},triggerUpdate:b=>{a(b||e).trigger("tsf-tooltip-update")}})}(jQuery),window.tsfTT.load();
